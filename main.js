(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{oQ:()=>I,hO:()=>l,fT:()=>U,t1:()=>B,Ag:()=>T});var t=function(e,t,n){var o=n.inputErrorClass,r=n.errorClass,c=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(o),c.classList.remove(r),c.textContent=""},n=function(e){return e.some((function(e){return!e.validity.valid}))},o=document.querySelectorAll(".popup"),r=document.querySelectorAll(".popup__btn-escape"),c=function(e,t){t&&I(t),e.classList.add("popup_opened"),document.addEventListener("keydown",s)},u=function(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",s)},a=function(e){e.target.classList.contains("popup")&&u(e.target)},s=function(e){"Escape"==e.key&&u(document.querySelector(".popup_opened"))};r.forEach((function(e){e.addEventListener("click",(function(){u(e.closest(".popup"))}))})),o.forEach((function(e){e.addEventListener("click",a)}));var l,i={baseUrl:"https://nomoreparties.co/v1/wbf-cohort-4",headers:{authorization:"73a44441-a56c-467a-8e71-8a108a581902","Content-Type":"application/json"}},p=function(){return fetch("".concat(i.baseUrl,"/cards"),{headers:i.headers})},d=document.querySelector(".elements__list"),f=document.querySelector("#element").content.querySelector(".element"),_=document.querySelector(".popup__image"),m=document.querySelector(".popup__caption"),v=document.querySelector(".popup_picture"),h=function(e){e.target.classList.toggle("element__button-heart_active");var t,n=e.target.closest(".element__btn-count").querySelector(".element__count-heart");e.target.classList.contains("element__button-heart_active")?(n.textContent=+n.textContent+1,(t=e.target.closest(".element").id,fetch("".concat(i.baseUrl,"/cards/likes/").concat(t),{method:"PUT",headers:i.headers})).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){console.log(e)})).catch((function(e){console.log("Ошибка: ".concat(e))})).finally((function(){}))):(n.textContent=+n.textContent-1,function(e){return fetch("https://nomoreparties.co/v1/wbf-cohort-4/cards/likes/".concat(e),{method:"DELETE",headers:i.headers})}(e.target.closest(".element").id).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){console.log(e)})).catch((function(e){console.log("Ошибка: ".concat(e))})).finally((function(){}))),0==n.textContent&&(n.textContent="")},y=function(e){d.prepend(function(e){var t=f.cloneNode(!0),n=t.querySelector(".element__image"),o=t.querySelector(".element__button-trash");return t.querySelector(".element__title").textContent=e.name,t.setAttribute("id",e._id),n.src=e.link,n.alt=e.name,e._id&&(function(e,t){e.likes.forEach((function(e){e._id===l&&t.querySelector(".element__button-heart").classList.add("element__button-heart_active")}))}(e,t),0!==e.likes.length&&(t.querySelector(".element__count-heart").textContent=e.likes.length),e.owner._id!==l?o.remove():o.addEventListener("click",(function(e){c(U,e)}))),t.querySelector(".element__button-heart").addEventListener("click",h),n.addEventListener("click",(function(){return function(e){_.src=e.link,_.alt=e.name,m.textContent=e.name,c(v)}(e)})),t}(e))};function S(e,t){var n=t.target.querySelector(".popup__btn");e?n.textContent="Сохранение...":n.classList.contains("popup__btn_submit")?n.textContent="Создать":n.textContent="Сохранить"}var C=document.querySelector(".popup__input_place"),b=document.querySelector(".popup__input_url"),q=document.querySelector(".popup__input_name"),E=document.querySelector(".popup__input_text"),g=document.querySelector(".popup__input_avatar"),L=document.querySelector(".profile__edit-button"),k=document.querySelector(".profile__add-button"),x=document.querySelector(".profile__avatar-overlay"),j=document.querySelector(".popup__form_add-card"),A=document.querySelector(".popup__form_edit-profile"),P=document.querySelector(".popup__form_avatar"),T=document.querySelector(".profile__title"),B=document.querySelector(".profile__subtitle"),U=document.querySelector(".popup_delete"),O=document.querySelector(".popup__form_delete"),w=document.querySelector(".profile__avatar-picture"),D=document.querySelector(".popup_edit-profile"),N=document.querySelector(".popup_add-card"),J=document.querySelector(".popup_avatar"),z=document.querySelector(".popup__btn_submit"),H=document.querySelector(".popup__btn_save"),M=document.querySelector(".popup__btn_avatar"),Q="popup__btn_inactive",F="popup__input_type_error",G="form__input-error_active";function I(e){O.addEventListener("submit",(function(t){t.preventDefault(),function(e){var t;e.target.closest(".element").remove(),(t=e.target.closest(".element").id,fetch("".concat(i.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:i.headers})).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){console.log(e)})).catch((function(e){console.log("Ошибка: ".concat(e))})).finally((function(){}))}(e),u(U)}))}x.addEventListener("click",(function(){M.classList.add(Q),M.setAttribute("disabled",!0),g.value="",t(P,g,{inputErrorClass:F,errorClass:G}),c(J)})),k.addEventListener("click",(function(){z.classList.add(Q),z.setAttribute("disabled",!0),C.value="",b.value="",t(j,C,{inputErrorClass:F,errorClass:G}),t(j,b,{inputErrorClass:F,errorClass:G}),c(N)})),L.addEventListener("click",(function(){q.value=T.textContent,E.value=B.textContent,H.classList.remove(Q),H.removeAttribute("disabled"),t(A,q,{inputErrorClass:F,errorClass:G}),t(A,E,{inputErrorClass:F,errorClass:G}),c(D)})),P.addEventListener("submit",(function(e){e.preventDefault(),w.src=g.value,u(J)})),A.addEventListener("submit",(function(e){var t,n;e.preventDefault(),console.log(e.target),T.textContent=q.value,B.textContent=E.value,S(!0,e),(t=q.value,n=E.value,fetch("".concat(i.baseUrl,"/users/me"),{method:"PATCH",headers:i.headers,body:JSON.stringify({name:t,about:n})})).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){console.log(e)})).catch((function(e){console.log("Ошибка: ".concat(e))})).finally((function(){S(!1,e)})),u(D)})),j.addEventListener("submit",(function(e){var t,n;e.preventDefault(),S(!0,e),(t=C.value,n=b.value,fetch("".concat(i.baseUrl,"/cards"),{method:"POST",headers:i.headers,body:JSON.stringify({name:t,link:n})})).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){console.log(e)})).catch((function(e){console.log("Ошибка: ".concat(e))})).finally((function(){S(!1,e)})),setTimeout((function(){p().then((function(e){return console.log(e.status,e.statusText),e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.reverse().forEach((function(e){e.name==C.value&&y(e)}))})).catch((function(e){console.log("Ошибка: ".concat(e))}))}),"100"),u(N)})),fetch("".concat(i.baseUrl,"/users/me"),{headers:i.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){var t;l=e._id,t=e,T.textContent=t.name,B.textContent=t.about})).catch((function(e){console.log("Ошибка: ".concat(e))})),p().then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.reverse().forEach((function(e){return y(e)}))})).catch((function(e){console.log("Ошибка: ".concat(e))})),function(e){var o=e.formSelector,r=e.inputSelector,c=e.submitButtonSelector,u=e.inactiveButtonClass,a=e.inputErrorClass,s=e.errorClass;Array.from(document.querySelectorAll(o)).forEach((function(e){!function(e,o){var r=o.inputSelector,c=o.submitButtonSelector,u=o.inactiveButtonClass,a=o.inputErrorClass,s=o.errorClass,l=Array.from(e.querySelectorAll(r)),i=e.querySelector(c);l.forEach((function(o){o.addEventListener("input",(function(){!function(e,n,o){var r=o.inputErrorClass,c=o.errorClass;n.validity.valid?t(e,n,{inputErrorClass:r,errorClass:c}):function(e,t,n,o){var r=o.inputErrorClass,c=o.errorClass,u=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r),u.textContent=n,u.classList.add(c)}(e,n,n.validationMessage,{inputErrorClass:r,errorClass:c})}(e,o,{inputErrorClass:a,errorClass:s}),function(e,t,o){console.log(n(e)),n(e)?(t.classList.add(o),t.setAttribute("disabled",!0)):(t.classList.remove(o),t.removeAttribute("disabled"))}(l,i,u)}))}))}(e,{formSelector:o,inputSelector:r,submitButtonSelector:c,inactiveButtonClass:u,inputErrorClass:a,errorClass:s})}))}({formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__btn",inactiveButtonClass:Q,inputErrorClass:F,errorClass:G})})();